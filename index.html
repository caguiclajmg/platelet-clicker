<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>血小板</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:image" content="https://platelets.fun/public/images/1.png">
    <meta property="og:type" content="website">
    <meta property="og:title" content="血小板">
    <meta property="og:description" content="">

    <link rel="stylesheet" type="text/css" href="public/styles/master.css">
</head>
<body>
    <noscript>Please enable JavaScript execution in your browser</noscript>

    <div id="div-root" class="container">
        <img id="image-normal" class="container-image" src="public/images/1.png">
        <img id="image-poke" class="container-image" src="public/images/2.png"/>

        <audio id="audio-music" loop volume="0.8">
            <source src="public/sounds/music.ogg" type="audio/ogg">
            <source src="public/sounds/music.mp3" type="audio/mpeg">
        </audio>
    </div>

    <script type="application/javascript">
        var divRoot = document.getElementById('div-root');

        var snd_click = new Audio('public/sounds/click.ogg');
        var snd_react = [new Audio('public/sounds/react1.ogg'), new Audio('public/sounds/react2.ogg')];

        var imageNormal = document.getElementById('image-normal');
        var imagePoke = document.getElementById('image-poke');
        var audioMusic = document.getElementById('audio-music');

        var clicks = 0;

        function toggleImage(down) {
            imageNormal.style.display = down ? 'none' : 'block';
            imagePoke.style.display = down ? 'block' : 'none';
        }

        function pok(e) {
            if(audioMusic.paused) audioMusic.play();

            snd_click.play();

            toggleImage(true);

            if(++clicks % 3 === 0) {
                var index = Math.floor(Math.random() * snd_react.length);
                snd_react[index].play();
            }
        }

        function releas(e) {
            toggleImage(false);
        }

        toggleImage(false);

        divRoot.addEventListener('mousedown', function(e) { if(e.button !== 0) return; pok(e); });
        divRoot.addEventListener('mouseup', function(e) { if(e.button !== 0) return; releas(e); });
        divRoot.addEventListener('touchstart', function(e) { pok(e); e.preventDefault(); });
        divRoot.addEventListener('touchmove', function(e) { e.preventDefault(); });
        divRoot.addEventListener('touchend', function(e) { releas(e); });
        divRoot.addEventListener('touchcancel', function(e) { releas(e); });
    </script>
</body>
</html>